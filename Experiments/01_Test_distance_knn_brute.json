{"cells":[{"cell_type":"markdown","metadata":{"id":"HgMtIqR-MX9o"},"source":["# Repertoire"],"id":"HgMtIqR-MX9o"},{"cell_type":"code","source":[""],"metadata":{"id":"FAfd8lZJhZd7"},"id":"FAfd8lZJhZd7","execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16434,"status":"ok","timestamp":1647866942186,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"},"user_tz":-60},"id":"TjdBkdZ7P56L","outputId":"a86f77d2-1703-4512-9832-1771d4c6fe71"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /gdrive\n"]}],"source":["try:\n","  from google.colab import drive\n","  drive.mount('/gdrive')\n","except:\n","  print(\"vous n'êtes encore  sur Google Colab\")"],"id":"TjdBkdZ7P56L"},{"cell_type":"code","execution_count":2,"metadata":{"id":"g1kXmCRjMLiI","executionInfo":{"status":"ok","timestamp":1647866942187,"user_tz":-60,"elapsed":9,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"}}},"outputs":[],"source":["REP_PROJET = '/gdrive/My Drive/Colab Notebooks/Dedoublement/'\n","REP_INPUT  = REP_PROJET + 'Input/'\n","REP_INTERMED  = REP_PROJET + 'Intermed/'\n","REP_OUTPUT  = REP_PROJET + 'Output/'"],"id":"g1kXmCRjMLiI"},{"cell_type":"markdown","metadata":{"id":"b03be4ec-137b-42ab-b0ec-cf100d72ffbd"},"source":["# MODULES"],"id":"b03be4ec-137b-42ab-b0ec-cf100d72ffbd"},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":501,"status":"ok","timestamp":1647866942681,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"},"user_tz":-60},"id":"jg0OzpzbPG-F","outputId":"53711fbc-8867-4058-f7fc-89e6219d56ac"},"outputs":[{"output_type":"stream","name":"stdout","text":["/gdrive/My Drive/Colab Notebooks/Dedoublement\n","/gdrive/My Drive/Colab Notebooks/Dedoublement\n"]}],"source":["%cd '/gdrive/My Drive/Colab Notebooks/Dedoublement/'\n","!pwd"],"id":"jg0OzpzbPG-F"},{"cell_type":"code","execution_count":null,"metadata":{"id":"tz-wV5S3R0je"},"outputs":[],"source":["%%capture\n","pip install -r requirements.txt"],"id":"tz-wV5S3R0je"},{"cell_type":"code","execution_count":null,"metadata":{"id":"1a9bf712-97f6-445a-99bc-02615f8a11e6"},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","import pickle\n","from datetime import datetime\n","from textdistance import damerau_levenshtein, jaro_winkler, sorensen_dice, jaccard, overlap, ratcliff_obershelp, levenshtein\n","from ngram import NGram\n","import Levenshtein\n"],"id":"1a9bf712-97f6-445a-99bc-02615f8a11e6"},{"cell_type":"markdown","metadata":{"id":"1485566a-46a5-408a-881e-9c7d5576d579"},"source":["# FUNCTIONS"],"id":"1485566a-46a5-408a-881e-9c7d5576d579"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4359,"status":"ok","timestamp":1647133738257,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"},"user_tz":-60},"id":"d257c1f1-7e57-44bb-9733-0253236dbe1d","outputId":"702383b6-9bdb-4d2d-c7c8-a8c2086ecbac"},"outputs":[{"name":"stderr","output_type":"stream","text":["ERROR:root:File `'00_functions.ipynb.py'` not found.\n"]}],"source":["%run \"00_functions.ipynb\""],"id":"d257c1f1-7e57-44bb-9733-0253236dbe1d"},{"cell_type":"markdown","metadata":{"id":"Qn9eFoPlwUJb"},"source":["# Data"],"id":"Qn9eFoPlwUJb"},{"cell_type":"markdown","metadata":{"id":"MOuTRa94wY8X"},"source":["## Importation des inputs"],"id":"MOuTRa94wY8X"},{"cell_type":"code","execution_count":15,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":223},"executionInfo":{"elapsed":23757,"status":"ok","timestamp":1647869891105,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"},"user_tz":-60},"id":"431c2da8-c2bd-4cf2-ac0e-e86d3fcaaec5","outputId":"1adcdb69-fe2b-43a4-80fa-ed4814e09f86"},"outputs":[{"output_type":"stream","name":"stdout","text":["dimension  de la table:  (8780046, 5)\n"]},{"output_type":"execute_result","data":{"text/plain":["  master_id released_date  country  \\\n","0         0    1970-03-00    japan   \n","1   2383348          1969    japan   \n","2         0          1991  germany   \n","3         0           nan     ussr   \n","4         0           nan       uk   \n","\n","                                                text  \n","0                                 \bEmanons (6)夜のしじまに  \n","1                 \bEmanons (6) = \bEmanons (6)小さな恋の物語  \n","2   \"Maly\" Moscow Symphonic Orchestra, The, Влади...  \n","3                         / Березка / Амурские Волны  \n","4                     /  /  /  /  /  /  /  /  / DVDr  "],"text/html":["\n","  <div id=\"df-739d0168-6a6d-4f8f-8771-0aef5e6de5c4\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>master_id</th>\n","      <th>released_date</th>\n","      <th>country</th>\n","      <th>text</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>1970-03-00</td>\n","      <td>japan</td>\n","      <td>\bEmanons (6)夜のしじまに</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2383348</td>\n","      <td>1969</td>\n","      <td>japan</td>\n","      <td>\bEmanons (6) = \bEmanons (6)小さな恋の物語</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>1991</td>\n","      <td>germany</td>\n","      <td>\"Maly\" Moscow Symphonic Orchestra, The, Влади...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>nan</td>\n","      <td>ussr</td>\n","      <td>/ Березка / Амурские Волны</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>nan</td>\n","      <td>uk</td>\n","      <td>/  /  /  /  /  /  /  /  / DVDr</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-739d0168-6a6d-4f8f-8771-0aef5e6de5c4')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-739d0168-6a6d-4f8f-8771-0aef5e6de5c4 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-739d0168-6a6d-4f8f-8771-0aef5e6de5c4');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":15}],"source":["baseline = pd.read_pickle(REP_INTERMED+ \"df_discogs_by_artist_tile.sav\")[['master_id','artist',\t'title']]\n","print('dimension  de la table: ' ,baseline.shape)\n","baseline['text'] =  baseline['artist'].astype(str) + baseline['title' ].astype(str)\n","baseline.drop(columns=['artist',\t'title'], inplace=True)\n","baseline.head()"],"id":"431c2da8-c2bd-4cf2-ac0e-e86d3fcaaec5"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":224},"executionInfo":{"elapsed":32347,"status":"ok","timestamp":1647135126683,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"},"user_tz":-60},"id":"8c2b3834-a4ba-447f-8b9a-1c4c7db0b089","outputId":"05b392b0-aff6-4607-86dc-9f11e7946c21"},"outputs":[{"name":"stdout","output_type":"stream","text":["dimension  de la table:  (100000, 3)\n"]},{"data":{"text/html":["\n","  <div id=\"df-0e47ca3d-503b-4456-8147-860dc40f0c91\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>n_ref</th>\n","      <th>text</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>113543790</td>\n","      <td>francis cabrel les chemins de traverse canada</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>119486700</td>\n","      <td>rina ketty la madone aux fleurs+3</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>117183052</td>\n","      <td>patrick moraz future memories : patrick moraz ...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>113717854</td>\n","      <td>ANAL VOMIT Demoniac Flagellations</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>115051043</td>\n","      <td>eddie palmieri sueño</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-0e47ca3d-503b-4456-8147-860dc40f0c91')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-0e47ca3d-503b-4456-8147-860dc40f0c91 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-0e47ca3d-503b-4456-8147-860dc40f0c91');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["       n_ref                                               text\n","0  113543790      francis cabrel les chemins de traverse canada\n","1  119486700                  rina ketty la madone aux fleurs+3\n","2  117183052  patrick moraz future memories : patrick moraz ...\n","3  113717854                  ANAL VOMIT Demoniac Flagellations\n","4  115051043                               eddie palmieri sueño"]},"execution_count":21,"metadata":{},"output_type":"execute_result"}],"source":["df = pd.read_excel(REP_INPUT +'2022-02-03_seller_reference_sample100K.xlsx')[['n_ref',\t'artiste',\t'titre']]\n","\n","print('dimension  de la table: ' ,df.shape)\n","\n","df['text'] =  df['artiste'].astype(str) + ' ' + df['titre'].astype(str)\n","df.drop(columns=['artiste',\t'titre'], inplace=True)\n","df.head()"],"id":"8c2b3834-a4ba-447f-8b9a-1c4c7db0b089"},{"cell_type":"code","source":["import pandas as pd\n","# df = pd.read_excel(REP_INPUT +'2022-02-03_seller_reference_sample100K.xlsx')\n","df.ref_actif.value_counts().reset_index().rename(columns={'index' : 'ref_actif', 'ref_actif':'count'}).to_excel(REP_INTERMED +\"ref_actif.xlsx\")"],"metadata":{"id":"t59MEipMhgTo","executionInfo":{"status":"ok","timestamp":1647867271667,"user_tz":-60,"elapsed":309,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"}}},"id":"t59MEipMhgTo","execution_count":11,"outputs":[]},{"cell_type":"code","source":["df.id_release.value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ivSHBnsDokkw","executionInfo":{"status":"ok","timestamp":1647868860694,"user_tz":-60,"elapsed":8,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"}},"outputId":"67018633-3687-4269-88c0-cb7a146ce58d"},"id":"ivSHBnsDokkw","execution_count":13,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0           97654\n","2685933         2\n","368528          2\n","375534          2\n","9939713         2\n","            ...  \n","10967           1\n","7933402         1\n","499316          1\n","20419861        1\n","11659607        1\n","Name: id_release, Length: 2339, dtype: int64"]},"metadata":{},"execution_count":13}]},{"cell_type":"markdown","metadata":{"id":"QIgtjcmjwnjq"},"source":["## Standarization des données textuelles\n"],"id":"QIgtjcmjwnjq"},{"cell_type":"code","execution_count":null,"metadata":{"id":"fdc203da-d865-4384-8e8d-21a1f2bea9c3"},"outputs":[],"source":["# from pandarallel import pandarallel\n","\n","# Initialization\n","# pandarallel.initialize(progress_bar=True, nb_workers=8)\n","\n","# start_time = datetime.now()\n","\n","# baseline[\"text_CLEAN\"]= baseline.parallel_apply(lambda p : make_text_prep_func(p, name_column_blacklist, name_column_regex_replace,\"text\"),axis=1)\n","\n","# end_time = datetime.now()\n","\n","# baseline.to_pickle(REP_INTERMED+ 'baseline1.sav')\n","\n","# print('Duration: {}'.format(end_time - start_time))"],"id":"fdc203da-d865-4384-8e8d-21a1f2bea9c3"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":9056,"status":"ok","timestamp":1647133346370,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"},"user_tz":-60},"id":"VolCaNDw_iNN","outputId":"23781fc8-8ff1-4789-dbcd-7010f1bb8af5"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-a120e1ea-a524-4171-a2b8-f682a6f506f9\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>master_id</th>\n","      <th>text</th>\n","      <th>text_CLEAN</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>\bEmanons (6)夜のしじまに</td>\n","      <td>\bemanon 6 Ye noshizimani</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2383348</td>\n","      <td>\bEmanons (6) = \bEmanons (6)小さな恋の物語</td>\n","      <td>\bemanon 6 \bemanon 6 Xiao sanaLian noWu Yu</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>\"Maly\" Moscow Symphonic Orchestra, The, Влади...</td>\n","      <td>maly moscow symphonic orchestr the vladimir po...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>/ Березка / Амурские Волны</td>\n","      <td>berezka amurskie volny</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>/  /  /  /  /  /  /  /  / DVDr</td>\n","      <td>dvdr</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a120e1ea-a524-4171-a2b8-f682a6f506f9')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a120e1ea-a524-4171-a2b8-f682a6f506f9 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a120e1ea-a524-4171-a2b8-f682a6f506f9');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["  master_id                                               text  \\\n","0         0                                 \bEmanons (6)夜のしじまに   \n","1   2383348                 \bEmanons (6) = \bEmanons (6)小さな恋の物語   \n","2         0   \"Maly\" Moscow Symphonic Orchestra, The, Влади...   \n","3         0                         / Березка / Амурские Волны   \n","4         0                     /  /  /  /  /  /  /  /  / DVDr   \n","\n","                                          text_CLEAN  \n","0                           \bemanon 6 Ye noshizimani  \n","1          \bemanon 6 \bemanon 6 Xiao sanaLian noWu Yu  \n","2  maly moscow symphonic orchestr the vladimir po...  \n","3                             berezka amurskie volny  \n","4                                               dvdr  "]},"execution_count":26,"metadata":{},"output_type":"execute_result"}],"source":["baseline = pd.read_pickle(REP_INTERMED+ 'baseline.sav')\n","baseline.head()"],"id":"VolCaNDw_iNN"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":355,"status":"ok","timestamp":1647108248200,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"},"user_tz":-60},"id":"x79PJpwb1KCt","outputId":"11792f35-54b6-4589-96a2-c51d7216c59f"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-17540fe7-b815-499f-91de-9ed0579eecb7\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>n_ref</th>\n","      <th>text</th>\n","      <th>ARTISTS_CLEAN</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>113543790</td>\n","      <td>francis cabrelles chemins de traverse canada</td>\n","      <td>franc cabrel chemin travers canad</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>119486700</td>\n","      <td>rina kettyla madone aux fleurs+3</td>\n","      <td>rin kettyl madon fleur 3</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>117183052</td>\n","      <td>patrick morazfuture memories : patrick moraz l...</td>\n","      <td>patrick morazfutur memor patrick moraz liv tv</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>113717854</td>\n","      <td>ANAL VOMITDemoniac Flagellations</td>\n","      <td>anal vomitdemoniac flagel</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>115051043</td>\n","      <td>eddie palmierisueño</td>\n","      <td>eddi palmierisueno</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-17540fe7-b815-499f-91de-9ed0579eecb7')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-17540fe7-b815-499f-91de-9ed0579eecb7 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-17540fe7-b815-499f-91de-9ed0579eecb7');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["       n_ref                                               text  \\\n","0  113543790       francis cabrelles chemins de traverse canada   \n","1  119486700                   rina kettyla madone aux fleurs+3   \n","2  117183052  patrick morazfuture memories : patrick moraz l...   \n","3  113717854                   ANAL VOMITDemoniac Flagellations   \n","4  115051043                                eddie palmierisueño   \n","\n","                                   ARTISTS_CLEAN  \n","0              franc cabrel chemin travers canad  \n","1                       rin kettyl madon fleur 3  \n","2  patrick morazfutur memor patrick moraz liv tv  \n","3                      anal vomitdemoniac flagel  \n","4                             eddi palmierisueno  "]},"execution_count":71,"metadata":{},"output_type":"execute_result"}],"source":["df_sellers = pd.read_pickle(REP_INTERMED+ 'df_sellers.sav')\n","df_sellers.head()"],"id":"x79PJpwb1KCt"},{"cell_type":"markdown","metadata":{"id":"l_OcP2c4px-B"},"source":["# Experimentations"],"id":"l_OcP2c4px-B"},{"cell_type":"markdown","metadata":{"id":"AXpO7RO0x7If"},"source":["## Cross joint both dataframes\n","\n","!!!! Thes dataframes are not those above."],"id":"AXpO7RO0x7If"},{"cell_type":"code","execution_count":null,"metadata":{"id":"182ec54d-c8f4-4733-858b-ee5509f8c96f"},"outputs":[],"source":["# Cross join\n","\n","to_drop = ['levenshtein',\t'RANG'\t,'jaro_winkler', 'jaccard',\t'overlap',\t'NGram',\t'RANG_jwr',\t'RANG_ngram', 'RANG_over', 'RANG_jacc']\n","\n","cross_joined = pd.read_pickle(REP_INTERMED + 'cross_join.sav')\n","\n","cross_joined = cross_joined.drop(columns=to_drop)\n"],"id":"182ec54d-c8f4-4733-858b-ee5509f8c96f"},{"cell_type":"markdown","metadata":{"id":"fzwj_tqQOMmP"},"source":["## Test on distance libraries"],"id":"fzwj_tqQOMmP"},{"cell_type":"markdown","metadata":{"id":"R0PfOh0lsbzZ"},"source":["### Compute levenshtein sim with python-levenshtein\n","\n","\n"],"id":"R0PfOh0lsbzZ"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6206,"status":"ok","timestamp":1647098477777,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"},"user_tz":-60},"id":"VEccyqic7WU0","outputId":"31b4cd1e-8d25-4943-9d1e-3993bd6b0e41"},"outputs":[{"name":"stdout","output_type":"stream","text":["Duration Python Levenshtein: 0:00:05.965284\n"]}],"source":["start_time = datetime.now()\n","\n","\n","cross_joined['python_levenshtein'] = cross_joined[['L_ARTISTS_CLEAN', 'R_ARTISTS_CLEAN']].apply(\n","\n","    lambda x: Levenshtein.ratio(*x),\n","\n","    axis=1,\n","    \n","    raw=True\n",")\n","end_time = datetime.now()\n","\n","print('Duration Python Levenshtein: {}'.format(end_time - start_time))"],"id":"VEccyqic7WU0"},{"cell_type":"markdown","metadata":{"id":"2651_ySHtRFG"},"source":["### compute levenshtein with fuzzy\n"],"id":"2651_ySHtRFG"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":11890,"status":"ok","timestamp":1647098489651,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"},"user_tz":-60},"id":"eCOjb8O_tQvr","outputId":"99f52e4d-2784-47c5-b680-e1b54d3c5bbf"},"outputs":[{"name":"stdout","output_type":"stream","text":["Duration Levenshtein fuzzy: 0:00:11.766903\n"]}],"source":["start_time = datetime.now()\n","\n","from fuzzywuzzy import fuzz\n","\n","\n","cross_joined['fuzzy_levenshtein'] = cross_joined[['L_ARTISTS_CLEAN', 'R_ARTISTS_CLEAN']].apply(\n","\n","    lambda x: fuzz.ratio(*x),\n","\n","    axis=1,\n","    \n","    raw=True\n",")\n","\n","end_time = datetime.now()\n","print('Duration Levenshtein fuzzy: {}'.format(end_time - start_time))"],"id":"eCOjb8O_tQvr"},{"cell_type":"markdown","metadata":{"id":"UgZFULris36v"},"source":["### Compute levenshtein sim with text distance\n"],"id":"UgZFULris36v"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19600,"status":"ok","timestamp":1647098509231,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"},"user_tz":-60},"id":"GPy3Pr1Mo60X","outputId":"d917f61c-5088-4fae-cd75-f5ee7247777e"},"outputs":[{"name":"stdout","output_type":"stream","text":["Duration Levenshtein textdistance: 0:00:19.577008\n"]}],"source":["start_time = datetime.now()\n","\n","cross_joined['textdistance_levenshtein'] = cross_joined[['L_ARTISTS_CLEAN', 'R_ARTISTS_CLEAN']].apply(\n","\n","    lambda x: levenshtein.normalized_similarity(*x),\n","\n","    axis=1,\n","    \n","    raw=True\n",")\n","\n","end_time = datetime.now()\n","print('Duration Levenshtein textdistance: {}'.format(end_time - start_time))"],"id":"GPy3Pr1Mo60X"},{"cell_type":"markdown","metadata":{"id":"cl-K6HOuuBkm"},"source":["## Compute Others distances"],"id":"cl-K6HOuuBkm"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":406},"executionInfo":{"elapsed":58,"status":"ok","timestamp":1647098509235,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"},"user_tz":-60},"id":"5d5D-Ayduc91","outputId":"5893a1fc-3da5-4c47-c2e1-eb6191e4bb21"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-8e4a3924-e5bd-4ce4-8780-7cd21a7e28e1\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>L_ARTISTS</th>\n","      <th>L_ARTISTS_CLEAN</th>\n","      <th>R_ARTISTS</th>\n","      <th>R_ARTISTS_CLEAN</th>\n","      <th>python_levenshtein</th>\n","      <th>fuzzy_levenshtein</th>\n","      <th>textdistance_levenshtein</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>PIXIES/MISSION/THROWING MUSE/DINOSAUR JR</td>\n","      <td>pix mission throwing mus dinosaur jr</td>\n","      <td>SEX PISTOLS - NEVER MIND THE BOLLOCKS HERE'S T...</td>\n","      <td>sex pistol nev mind the bollock her the</td>\n","      <td>0.373333</td>\n","      <td>37</td>\n","      <td>0.307692</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>PIXIES/MISSION/THROWING MUSE/DINOSAUR JR</td>\n","      <td>pix mission throwing mus dinosaur jr</td>\n","      <td>SCIENTIST V PRINCE JAMMY</td>\n","      <td>scientist v princ jammy</td>\n","      <td>0.372881</td>\n","      <td>37</td>\n","      <td>0.222222</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>PIXIES/MISSION/THROWING MUSE/DINOSAUR JR</td>\n","      <td>pix mission throwing mus dinosaur jr</td>\n","      <td>SAMMY CROPPER AND HIS WIRE CONNECTIONS</td>\n","      <td>sammy cropp his wir connect</td>\n","      <td>0.317460</td>\n","      <td>32</td>\n","      <td>0.222222</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>PIXIES/MISSION/THROWING MUSE/DINOSAUR JR</td>\n","      <td>pix mission throwing mus dinosaur jr</td>\n","      <td>SHAZAM X  FEAT. PERCEE P &amp; SICK LYRICAL</td>\n","      <td>shazam x perce p sick lyrical</td>\n","      <td>0.246154</td>\n","      <td>25</td>\n","      <td>0.138889</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>PIXIES/MISSION/THROWING MUSE/DINOSAUR JR</td>\n","      <td>pix mission throwing mus dinosaur jr</td>\n","      <td>LADY GAGA FEAT BEYONCE</td>\n","      <td>lady gag beyonc</td>\n","      <td>0.156863</td>\n","      <td>16</td>\n","      <td>0.111111</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8e4a3924-e5bd-4ce4-8780-7cd21a7e28e1')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-8e4a3924-e5bd-4ce4-8780-7cd21a7e28e1 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-8e4a3924-e5bd-4ce4-8780-7cd21a7e28e1');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["                                  L_ARTISTS  \\\n","0  PIXIES/MISSION/THROWING MUSE/DINOSAUR JR   \n","1  PIXIES/MISSION/THROWING MUSE/DINOSAUR JR   \n","2  PIXIES/MISSION/THROWING MUSE/DINOSAUR JR   \n","3  PIXIES/MISSION/THROWING MUSE/DINOSAUR JR   \n","4  PIXIES/MISSION/THROWING MUSE/DINOSAUR JR   \n","\n","                        L_ARTISTS_CLEAN  \\\n","0  pix mission throwing mus dinosaur jr   \n","1  pix mission throwing mus dinosaur jr   \n","2  pix mission throwing mus dinosaur jr   \n","3  pix mission throwing mus dinosaur jr   \n","4  pix mission throwing mus dinosaur jr   \n","\n","                                           R_ARTISTS  \\\n","0  SEX PISTOLS - NEVER MIND THE BOLLOCKS HERE'S T...   \n","1                           SCIENTIST V PRINCE JAMMY   \n","2             SAMMY CROPPER AND HIS WIRE CONNECTIONS   \n","3            SHAZAM X  FEAT. PERCEE P & SICK LYRICAL   \n","4                             LADY GAGA FEAT BEYONCE   \n","\n","                           R_ARTISTS_CLEAN  python_levenshtein  \\\n","0  sex pistol nev mind the bollock her the            0.373333   \n","1                  scientist v princ jammy            0.372881   \n","2              sammy cropp his wir connect            0.317460   \n","3            shazam x perce p sick lyrical            0.246154   \n","4                          lady gag beyonc            0.156863   \n","\n","   fuzzy_levenshtein  textdistance_levenshtein  \n","0                 37                  0.307692  \n","1                 37                  0.222222  \n","2                 32                  0.222222  \n","3                 25                  0.138889  \n","4                 16                  0.111111  "]},"execution_count":45,"metadata":{},"output_type":"execute_result"}],"source":["cross_joined.head()"],"id":"5d5D-Ayduc91"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":530},"executionInfo":{"elapsed":217817,"status":"ok","timestamp":1647098744077,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"},"user_tz":-60},"id":"e701488e-1d40-475d-83a4-36c3fbb57b0c","outputId":"f52a04c3-8e6f-4104-fb2f-83c12904bbbe"},"outputs":[{"name":"stdout","output_type":"stream","text":["Duration: 0:03:37.600166\n"]},{"data":{"text/html":["\n","  <div id=\"df-c7b3ddac-f5e8-4d9d-8b19-e62f01146c61\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>L_ARTISTS</th>\n","      <th>L_ARTISTS_CLEAN</th>\n","      <th>R_ARTISTS</th>\n","      <th>R_ARTISTS_CLEAN</th>\n","      <th>python_levenshtein</th>\n","      <th>fuzzy_levenshtein</th>\n","      <th>textdistance_levenshtein</th>\n","      <th>jaro_winkler</th>\n","      <th>jaccard</th>\n","      <th>overlap</th>\n","      <th>NGram</th>\n","      <th>mean_similarities</th>\n","      <th>RANG</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>PIXIES/MISSION/THROWING MUSE/DINOSAUR JR</td>\n","      <td>pix mission throwing mus dinosaur jr</td>\n","      <td>SEX PISTOLS - NEVER MIND THE BOLLOCKS HERE'S T...</td>\n","      <td>sex pistol nev mind the bollock her the</td>\n","      <td>0.373333</td>\n","      <td>0.37</td>\n","      <td>0.307692</td>\n","      <td>0.548535</td>\n","      <td>0.388889</td>\n","      <td>0.583333</td>\n","      <td>0.132353</td>\n","      <td>0.386305</td>\n","      <td>43.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>PIXIES/MISSION/THROWING MUSE/DINOSAUR JR</td>\n","      <td>pix mission throwing mus dinosaur jr</td>\n","      <td>SCIENTIST V PRINCE JAMMY</td>\n","      <td>scientist v princ jammy</td>\n","      <td>0.372881</td>\n","      <td>0.37</td>\n","      <td>0.222222</td>\n","      <td>0.567391</td>\n","      <td>0.404762</td>\n","      <td>0.739130</td>\n","      <td>0.051724</td>\n","      <td>0.389730</td>\n","      <td>44.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>PIXIES/MISSION/THROWING MUSE/DINOSAUR JR</td>\n","      <td>pix mission throwing mus dinosaur jr</td>\n","      <td>SAMMY CROPPER AND HIS WIRE CONNECTIONS</td>\n","      <td>sammy cropp his wir connect</td>\n","      <td>0.317460</td>\n","      <td>0.32</td>\n","      <td>0.222222</td>\n","      <td>0.585932</td>\n","      <td>0.500000</td>\n","      <td>0.777778</td>\n","      <td>0.120690</td>\n","      <td>0.406297</td>\n","      <td>98.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>PIXIES/MISSION/THROWING MUSE/DINOSAUR JR</td>\n","      <td>pix mission throwing mus dinosaur jr</td>\n","      <td>SHAZAM X  FEAT. PERCEE P &amp; SICK LYRICAL</td>\n","      <td>shazam x perce p sick lyrical</td>\n","      <td>0.246154</td>\n","      <td>0.25</td>\n","      <td>0.138889</td>\n","      <td>0.498723</td>\n","      <td>0.326531</td>\n","      <td>0.551724</td>\n","      <td>0.030769</td>\n","      <td>0.291827</td>\n","      <td>157.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>PIXIES/MISSION/THROWING MUSE/DINOSAUR JR</td>\n","      <td>pix mission throwing mus dinosaur jr</td>\n","      <td>LADY GAGA FEAT BEYONCE</td>\n","      <td>lady gag beyonc</td>\n","      <td>0.156863</td>\n","      <td>0.16</td>\n","      <td>0.111111</td>\n","      <td>0.334259</td>\n","      <td>0.159091</td>\n","      <td>0.466667</td>\n","      <td>0.039216</td>\n","      <td>0.203887</td>\n","      <td>195.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c7b3ddac-f5e8-4d9d-8b19-e62f01146c61')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c7b3ddac-f5e8-4d9d-8b19-e62f01146c61 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c7b3ddac-f5e8-4d9d-8b19-e62f01146c61');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["                                  L_ARTISTS  \\\n","0  PIXIES/MISSION/THROWING MUSE/DINOSAUR JR   \n","1  PIXIES/MISSION/THROWING MUSE/DINOSAUR JR   \n","2  PIXIES/MISSION/THROWING MUSE/DINOSAUR JR   \n","3  PIXIES/MISSION/THROWING MUSE/DINOSAUR JR   \n","4  PIXIES/MISSION/THROWING MUSE/DINOSAUR JR   \n","\n","                        L_ARTISTS_CLEAN  \\\n","0  pix mission throwing mus dinosaur jr   \n","1  pix mission throwing mus dinosaur jr   \n","2  pix mission throwing mus dinosaur jr   \n","3  pix mission throwing mus dinosaur jr   \n","4  pix mission throwing mus dinosaur jr   \n","\n","                                           R_ARTISTS  \\\n","0  SEX PISTOLS - NEVER MIND THE BOLLOCKS HERE'S T...   \n","1                           SCIENTIST V PRINCE JAMMY   \n","2             SAMMY CROPPER AND HIS WIRE CONNECTIONS   \n","3            SHAZAM X  FEAT. PERCEE P & SICK LYRICAL   \n","4                             LADY GAGA FEAT BEYONCE   \n","\n","                           R_ARTISTS_CLEAN  python_levenshtein  \\\n","0  sex pistol nev mind the bollock her the            0.373333   \n","1                  scientist v princ jammy            0.372881   \n","2              sammy cropp his wir connect            0.317460   \n","3            shazam x perce p sick lyrical            0.246154   \n","4                          lady gag beyonc            0.156863   \n","\n","   fuzzy_levenshtein  textdistance_levenshtein  jaro_winkler   jaccard  \\\n","0               0.37                  0.307692      0.548535  0.388889   \n","1               0.37                  0.222222      0.567391  0.404762   \n","2               0.32                  0.222222      0.585932  0.500000   \n","3               0.25                  0.138889      0.498723  0.326531   \n","4               0.16                  0.111111      0.334259  0.159091   \n","\n","    overlap     NGram  mean_similarities   RANG  \n","0  0.583333  0.132353           0.386305   43.0  \n","1  0.739130  0.051724           0.389730   44.0  \n","2  0.777778  0.120690           0.406297   98.0  \n","3  0.551724  0.030769           0.291827  157.0  \n","4  0.466667  0.039216           0.203887  195.0  "]},"execution_count":46,"metadata":{},"output_type":"execute_result"}],"source":["colonnes = ['jaro_winkler', 'jaccard', 'overlap', 'NGram']\n","\n","start_time = datetime.now()\n","\n","cross_joined['fuzzy_levenshtein'] = cross_joined['fuzzy_levenshtein']/100\n","\n","col_list_values = cross_joined.apply(lambda p:compound_similarity(p,\"L_ARTISTS_CLEAN\",  \"R_ARTISTS_CLEAN\"), axis=1)\n","cross_joined[colonnes] = pd.DataFrame(np.column_stack(col_list_values).T, columns=colonnes)\n","cross_joined['mean_similarities'] =  cross_joined.mean(axis=1, numeric_only=True)\n","\n","cross_joined[\"RANG\"]   = cross_joined.groupby(by=\"L_ARTISTS\")[\"python_levenshtein\"].rank(\"dense\", ascending=False)\n","\n","\n","end_time = datetime.now()\n","print('Duration: {}'.format(end_time - start_time))\n","cross_joined.head()"],"id":"e701488e-1d40-475d-83a4-36c3fbb57b0c"},{"cell_type":"code","execution_count":null,"metadata":{"id":"fl0lZWNPslTF"},"outputs":[],"source":["#start_time = datetime.now()\n","\n","#cross_joined['evenshtein'] = cross_joined[['L_ARTISTS_CLEAN', 'R_ARTISTS_CLEAN']].apply(\n","\n","#    lambda x: damerauLevenshtein(*x,similarity=True),\n","\n","#    axis=1,\n","    \n","#    raw=True\n","#)\n","\n","# end_time = datetime.now()\n","\n","#print('Duration  Damerau Levenshtein: {}'.format(end_time - start_time))"],"id":"fl0lZWNPslTF"},{"cell_type":"markdown","metadata":{"id":"tB9HEF4UvVt0"},"source":["\n","\n","\n","\n","## Find The 20 nearest neighbors Artist + Text via similarities"],"id":"tB9HEF4UvVt0"},{"cell_type":"code","execution_count":null,"metadata":{"id":"zsiEP1cW1M5K"},"outputs":[],"source":["def knn_text_distance(query, baseline_text) :\n","\n","  return Levenshtein.ratio(make_text_prep_func(query), baseline_text)"],"id":"zsiEP1cW1M5K"},{"cell_type":"code","execution_count":null,"metadata":{"id":"3_zuLuIy5WzI"},"outputs":[],"source":["baseline = pd.read_pickle(REP_INTERMED+ 'baseline.sav')"],"id":"3_zuLuIy5WzI"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4387199,"status":"ok","timestamp":1647113893785,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"},"user_tz":-60},"id":"akJb71Kf4otc","outputId":"4b604075-3fec-42f6-8b77-073b7118500f"},"outputs":[{"name":"stdout","output_type":"stream","text":["Duration: 1:23:42.017623\n"]}],"source":["query = 'rina kettyla madone aux fleurs+3'\n","start_time = datetime.now()\n","\n","results = [ knn_text_distance(query, baseline_text)  \n","\n","    for baseline_text  in  baseline.iloc[:, 2]\n","]\n","\n","end_time = datetime.now()\n","\n","\n","print('Duration: {}'.format(end_time - start_time))\n","\n","#file= open(REP_INTERMED + 'distance.pkl', 'wb')\n","#pickle.dump(results, file) \n","#file.close()\n","# Duration: 1:23:40.310394\n"],"id":"akJb71Kf4otc"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4450284,"status":"ok","timestamp":1647139730927,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"},"user_tz":-60},"id":"cVwCK0Bq6GJ7","outputId":"c7ee8341-a32f-4654-ca73-b02515d13a9d"},"outputs":[{"name":"stdout","output_type":"stream","text":["Duration: 1:14:09.443759\n"]}],"source":["query = 'bob marley uprising'\n","\n","start_time = datetime.now()\n","\n","results2 = [ knn_text_distance(query, baseline_text)  \n","\n","    for baseline_text  in  baseline.iloc[:, 2]\n","]\n","\n","end_time = datetime.now()\n","\n","\n","print('Duration: {}'.format(end_time - start_time))\n","\n","file= open(REP_INTERMED + 'distance2.pkl', 'wb')\n","pickle.dump(results2, file) \n","file.close()"],"id":"cVwCK0Bq6GJ7"},{"cell_type":"code","execution_count":null,"metadata":{"id":"f31cx1Xy_eFE"},"outputs":[],"source":[""],"id":"f31cx1Xy_eFE"},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":676},"executionInfo":{"elapsed":9193,"status":"ok","timestamp":1647133784596,"user":{"displayName":"Salif Sawadogo","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjrN7O-mxSEYOIj-QZXGrosnsBarzx-mzkA-2cUSQ=s64","userId":"02963866923297356969"},"user_tz":-60},"id":"hWvKhuHBxcTN","outputId":"e4f3e5e2-81fa-479b-be04-ed84460820aa"},"outputs":[{"data":{"text/html":["\n","  <div id=\"df-ccca6eb3-20e4-40c5-8b96-7fba58f562fb\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>master_id</th>\n","      <th>text</th>\n","      <th>text_CLEAN</th>\n","      <th>similarity</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>5725209</th>\n","      <td>1826761</td>\n","      <td>Rina KettyLa Madone Aux Fleurs</td>\n","      <td>rin kettyl madon fleur</td>\n","      <td>0.956522</td>\n","    </tr>\n","    <tr>\n","      <th>5725210</th>\n","      <td>0</td>\n","      <td>Rina KettyLa Madone Aux Fleurs / Pres De Naple...</td>\n","      <td>rin kettyl madon fleur pre napl jol</td>\n","      <td>0.779661</td>\n","    </tr>\n","    <tr>\n","      <th>5725230</th>\n","      <td>0</td>\n","      <td>Rina KettyPrière À La Madone Volume 2</td>\n","      <td>rin kettypri madon volum 2</td>\n","      <td>0.760000</td>\n","    </tr>\n","    <tr>\n","      <th>5725222</th>\n","      <td>899956</td>\n","      <td>Rina KettyLes Chansons Formidables</td>\n","      <td>rin kettyl chanson formid</td>\n","      <td>0.693878</td>\n","    </tr>\n","    <tr>\n","      <th>4425782</th>\n","      <td>0</td>\n","      <td>Martin KobyL'Amour Fleurit</td>\n","      <td>martin kobyl amour fleur</td>\n","      <td>0.666667</td>\n","    </tr>\n","    <tr>\n","      <th>673675</th>\n","      <td>0</td>\n","      <td>Berthe SylvaLa Madone Aux Fleurs</td>\n","      <td>berth sylval madon fleur</td>\n","      <td>0.666667</td>\n","    </tr>\n","    <tr>\n","      <th>5725186</th>\n","      <td>0</td>\n","      <td>Rina KettyCes Fabuleuses Années 30</td>\n","      <td>rin kettyc fabul anne 30</td>\n","      <td>0.666667</td>\n","    </tr>\n","    <tr>\n","      <th>5725211</th>\n","      <td>0</td>\n","      <td>Rina KettyLa Maison Sur La Colline / Chercher ...</td>\n","      <td>rin kettyl maison collin cherch oubl</td>\n","      <td>0.666667</td>\n","    </tr>\n","    <tr>\n","      <th>5725208</th>\n","      <td>1330123</td>\n","      <td>Rina KettyL'hirondelle D'amour</td>\n","      <td>rin kettyl hirondel amour</td>\n","      <td>0.653061</td>\n","    </tr>\n","    <tr>\n","      <th>5725234</th>\n","      <td>0</td>\n","      <td>Rina KettyRien Que Mon Coeur</td>\n","      <td>rin kettyrien coeur</td>\n","      <td>0.651163</td>\n","    </tr>\n","    <tr>\n","      <th>5725203</th>\n","      <td>0</td>\n","      <td>Rina KettyJe N'Ai Qu'Une Maman</td>\n","      <td>rin kettyj maman</td>\n","      <td>0.650000</td>\n","    </tr>\n","    <tr>\n","      <th>5725247</th>\n","      <td>0</td>\n","      <td>Rina KettyTes Bras / Du Flot Charmeur</td>\n","      <td>rin kettyt bras flot charmeur</td>\n","      <td>0.641509</td>\n","    </tr>\n","    <tr>\n","      <th>5725213</th>\n","      <td>0</td>\n","      <td>Rina KettyLe Clocher D'amour / Rien Que Mon Coeur</td>\n","      <td>rin kettyl cloch amour rien coeur</td>\n","      <td>0.631579</td>\n","    </tr>\n","    <tr>\n","      <th>5725204</th>\n","      <td>0</td>\n","      <td>Rina KettyJe N'Ai Qu'Une Maman ! / Pourquoi Lo...</td>\n","      <td>rin kettyj maman pourquoi loin</td>\n","      <td>0.629630</td>\n","    </tr>\n","    <tr>\n","      <th>5725193</th>\n","      <td>388769</td>\n","      <td>Rina KettyJ'Attendrai</td>\n","      <td>rin kettyj attendr</td>\n","      <td>0.619048</td>\n","    </tr>\n","    <tr>\n","      <th>5725199</th>\n","      <td>0</td>\n","      <td>Rina KettyJ'attendrai</td>\n","      <td>rin kettyj attendr</td>\n","      <td>0.619048</td>\n","    </tr>\n","    <tr>\n","      <th>5725189</th>\n","      <td>0</td>\n","      <td>Rina KettyChante Ses Grands Succes</td>\n","      <td>rin kettych grand succ</td>\n","      <td>0.608696</td>\n","    </tr>\n","    <tr>\n","      <th>5725253</th>\n","      <td>1141711</td>\n","      <td>Rina KettyÉtoiles De La Chanson</td>\n","      <td>rin kettyetoil chanson</td>\n","      <td>0.608696</td>\n","    </tr>\n","    <tr>\n","      <th>5725972</th>\n","      <td>1208567</td>\n","      <td>Ringo (6)Made In Ailleurs</td>\n","      <td>ringo 6 mad in ailleur</td>\n","      <td>0.608696</td>\n","    </tr>\n","    <tr>\n","      <th>4846170</th>\n","      <td>0</td>\n","      <td>Nathalie SimardNon Ne Pleure Pas</td>\n","      <td>nathal simardnon pleur</td>\n","      <td>0.608696</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ccca6eb3-20e4-40c5-8b96-7fba58f562fb')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-ccca6eb3-20e4-40c5-8b96-7fba58f562fb button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-ccca6eb3-20e4-40c5-8b96-7fba58f562fb');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "],"text/plain":["        master_id                                               text  \\\n","5725209   1826761                     Rina KettyLa Madone Aux Fleurs   \n","5725210         0  Rina KettyLa Madone Aux Fleurs / Pres De Naple...   \n","5725230         0              Rina KettyPrière À La Madone Volume 2   \n","5725222    899956                 Rina KettyLes Chansons Formidables   \n","4425782         0                         Martin KobyL'Amour Fleurit   \n","673675          0                   Berthe SylvaLa Madone Aux Fleurs   \n","5725186         0                 Rina KettyCes Fabuleuses Années 30   \n","5725211         0  Rina KettyLa Maison Sur La Colline / Chercher ...   \n","5725208   1330123                     Rina KettyL'hirondelle D'amour   \n","5725234         0                       Rina KettyRien Que Mon Coeur   \n","5725203         0                     Rina KettyJe N'Ai Qu'Une Maman   \n","5725247         0              Rina KettyTes Bras / Du Flot Charmeur   \n","5725213         0  Rina KettyLe Clocher D'amour / Rien Que Mon Coeur   \n","5725204         0  Rina KettyJe N'Ai Qu'Une Maman ! / Pourquoi Lo...   \n","5725193    388769                              Rina KettyJ'Attendrai   \n","5725199         0                              Rina KettyJ'attendrai   \n","5725189         0                 Rina KettyChante Ses Grands Succes   \n","5725253   1141711                    Rina KettyÉtoiles De La Chanson   \n","5725972   1208567                          Ringo (6)Made In Ailleurs   \n","4846170         0                   Nathalie SimardNon Ne Pleure Pas   \n","\n","                                   text_CLEAN  similarity  \n","5725209                rin kettyl madon fleur    0.956522  \n","5725210   rin kettyl madon fleur pre napl jol    0.779661  \n","5725230            rin kettypri madon volum 2    0.760000  \n","5725222             rin kettyl chanson formid    0.693878  \n","4425782              martin kobyl amour fleur    0.666667  \n","673675               berth sylval madon fleur    0.666667  \n","5725186              rin kettyc fabul anne 30    0.666667  \n","5725211  rin kettyl maison collin cherch oubl    0.666667  \n","5725208             rin kettyl hirondel amour    0.653061  \n","5725234                   rin kettyrien coeur    0.651163  \n","5725203                      rin kettyj maman    0.650000  \n","5725247         rin kettyt bras flot charmeur    0.641509  \n","5725213     rin kettyl cloch amour rien coeur    0.631579  \n","5725204        rin kettyj maman pourquoi loin    0.629630  \n","5725193                    rin kettyj attendr    0.619048  \n","5725199                    rin kettyj attendr    0.619048  \n","5725189                rin kettych grand succ    0.608696  \n","5725253                rin kettyetoil chanson    0.608696  \n","5725972                ringo 6 mad in ailleur    0.608696  \n","4846170                nathal simardnon pleur    0.608696  "]},"execution_count":9,"metadata":{},"output_type":"execute_result"}],"source":["with open(REP_INTERMED + 'distance.pkl', 'rb') as file:\n","        sim = pickle.load(file)\n","\n","baseline['similarity'] = sim\n","\n","# Find tHE 30 similar text\n","result =  baseline.sort_values(by='similarity', ascending=False)\n","result.head(20)\n"],"id":"hWvKhuHBxcTN"},{"cell_type":"code","execution_count":null,"metadata":{"id":"Mx_JEjuS9psA"},"outputs":[],"source":["baseline = pd.read_pickle(REP_INTERMED+ 'baseline.sav')\n","\n","with open(REP_INTERMED + 'distance2.pkl', 'rb') as file:\n","        sim = pickle.load(file)\n","\n","baseline['similarity'] = sim\n","\n","# Find tHE 30 similar text\n","result =  baseline.sort_values(by='similarity', ascending=False)\n","result.head(20)"],"id":"Mx_JEjuS9psA"},{"cell_type":"code","execution_count":null,"metadata":{"id":"QfUo72GczL7l"},"outputs":[],"source":["#result.head(20).to_excel(REP_INTERMED + 'report_brute_knn.xlsx')"],"id":"QfUo72GczL7l"}],"metadata":{"colab":{"collapsed_sections":[],"name":"01_Test_distance_knn_brute","provenance":[]},"kernelspec":{"display_name":"Python 3 (ipykernel)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.9.7"}},"nbformat":4,"nbformat_minor":5}